var __bind=function(t,i){return function(){return t.apply(i,arguments)}};!function(t){return this.FilmRoll=function(){function i(i){this.options=null!=i?i:{},this.rotateRight=__bind(this.rotateRight,this),this.rotateLeft=__bind(this.rotateLeft,this),this.resize=__bind(this.resize,this),this.moveRight=__bind(this.moveRight,this),this.moveLeft=__bind(this.moveLeft,this),this.clearScroll=__bind(this.clearScroll,this),this.configureScroll=__bind(this.configureScroll,this),this.configureWidths=__bind(this.configureWidths,this),this.configureLoad=__bind(this.configureLoad,this),this.configureHover=__bind(this.configureHover,this),this.options.container&&(this.div=t(this.options.container),this.div.length&&this.configure())}return i.prototype.configure=function(){var e,s=this;return this.children=this.div.children(),this.children.wrapAll('<div class="film_roll_wrapper"></div>'),this.children.wrapAll('<div class="film_roll_shuttle"></div>'),this.wrapper=this.div.find(".film_roll_wrapper"),this.shuttle=this.div.find(".film_roll_shuttle"),this.rotation=[],this.shuttle.width(this.options.shuttle_width?parseInt(this.options.shuttle_width,10):1e4),this.options.start_height&&this.wrapper.height(parseInt(this.options.start_height,10)),this.options.vertical_center&&this.shuttle.addClass("vertical_center"),this.options.no_css===!0||document.film_roll_styles_added||(t("<style type='text/css'></style>").appendTo("head"),document.film_roll_styles_added=!0),this.options.pager!==!1&&(this.pager=t('<div class="film_roll_pager">'),this.div.append(this.pager),this.children.each(function(i,e){var r;return r=t("<a href='#' data-id='"+e.id+"'><span>"+(i+1)+"</span></a>"),s.pager.append(r),r.click(function(){return s.index=i,s.moveToIndex(s.index,"best",!0),!1})})),this.pager_links=this.div.find(".film_roll_pager a"),"scroll"===this.options.hover?(this.options.scroll=!1,this.hover_in=function(){return clearTimeout(s.hover_timer),s.hover_timer=setTimeout(function(){return s.moveLeft(),s.configureScroll()},300)},this.hover_out=this.clearScroll):this.options.hover!==!1&&(this.hover_in=function(){return clearTimeout(s.hover_timer),s.hover_timer=setTimeout(function(){return s.clearScroll()},300)},this.hover_out=this.configureScroll),this.options.hover!==!1&&(this.mouse_catcher=t('<div style="position:absolute; top:0; left: 0; height: 100%; width: 100%;" class="film_roll_mouse_catcher"></div>'),this.mouse_catcher.appendTo(this.wrapper).mousemove(function(){return s.hover_in(),s.mouse_catcher.remove()})),e=null,this.children.each(function(i,e){var r;return r=t(e),r.attr("data-film-roll-child-id",i),r.addClass("film_roll_child"),s.rotation.push(e)}),this.options.prev&&this.options.next?(this.prev=t(this.options.prev),this.next=t(this.options.next)):(this.wrapper.append('<a class="film-roll-prev" href="#">&lsaquo;</a>'),this.wrapper.append('<a class="film-roll-next" href="#">&rsaquo;</a>'),this.prev=this.div.find(".film-roll-prev"),this.next=this.div.find(".film-roll-next")),this.prev.click(function(){return s.moveRight()}),this.next.click(function(){return s.moveLeft()}),this.index=this.options.start_index||0,this.interval=this.options.interval||4e3,this.animation=this.options.animation||this.interval/4,this.easing=this.options.easing||i.default_easing,this.options.resize!==!1&&t(window).resize(function(){return s.resize()}),this.options.configure_load?"function"==typeof this.options.configure_load?this.options.configure_load.apply(this,arguments):this.configureLoad():t(window).load(this.configureLoad),this.div.trigger(t.Event("film_roll:dom_ready")),this},i.prototype.bestDirection=function(i,e){return e||(e=t.inArray(i,this.rotation)),e<this.children.length/2?"right":"left"},i.prototype.configureHover=function(){return this.div.hover(this.hover_in,this.hover_out),this.options.prev&&this.options.next?(this.prev.hover(this.hover_in,this.hover_out),this.next.hover(this.hover_in,this.hover_out)):void 0},i.prototype.configureLoad=function(){return this.configureWidths(),this.moveToIndex(this.index,"right",!0),"scroll"===this.options.hover?(this.options.scroll=!1,this.configureHover()):this.options.scroll!==!1&&(this.configureScroll(),this.options.hover!==!1)?this.configureHover():void 0},i.prototype.configureWidths=function(){var i,e=this;return this.width=i=0,this.wrapper.css({height:"","min-height":0}),this.shuttle.width("").removeClass("film_roll_shuttle").addClass("film_roll_resizing"),this.children.width(""),this.div.trigger(t.Event("film_roll:resizing")),this.child_widths=[],this.children.each(function(s,r){var h,o,n;return h=t(r),n=h.outerWidth(!0),h.width(n),e.child_widths.push(n),e.width+=n,e.options.height||(o=h.outerHeight(!0),o>i&&(i=o)),r}),this.options.height?this.wrapper.height(this.options.height):(this.wrapper.height(""),this.wrapper.css("min-height",i)),this.real_width=this.width,this.shuttle.width(2*this.real_width).removeClass("film_roll_resizing").addClass("film_roll_shuttle"),this},i.prototype.configureScroll=function(){var t=this;return this.scrolled!==!0&&(this.timer=setInterval(function(){return t.moveLeft()},this.interval),this.scrolled=!0),this},i.prototype.clearScroll=function(){return this.scrolled!==!1&&(clearInterval(this.timer),this.scrolled=!1),this},i.prototype.childIndex=function(i){return t.inArray(i,this.children)},i.prototype.childWidth=function(i){var e;return e=this.childIndex(i),this.child_widths[e]||t(i).outerWidth(!0)},i.prototype.rotationIndex=function(i){return t.inArray(i,this.rotation)},i.prototype.marginLeft=function(t,i){var e,s,r,h,o,n;for(null==i&&(i=0),r=0,n=this.rotation,s=h=0,o=n.length;o>h;s=++h)e=n[s],t>s&&s>=i&&(r+=this.childWidth(e));return r},i.prototype.marginRight=function(t,i){var e,s,r,h,o,n;for(null==i&&(i=0),i=this.rotation.length-i-1,r=0,n=this.rotation,s=h=0,o=n.length;o>h;s=++h)e=n[s],s>t&&i>=s&&(r+=this.childWidth(e));return r},i.prototype.moveLeft=function(){return this.index=(this.index+1)%this.children.length,this.moveToIndex(this.index,"left",!0),!1},i.prototype.moveRight=function(){return this.index-=1,this.index<0&&(this.index=this.children.length-1),this.moveToIndex(this.index,"right",!0),!1},i.prototype.moveToChild=function(i){var e;return e=this.childIndex(t(i)[0]),e>-1?this.moveToIndex(e):void 0},i.prototype.moveToIndex=function(i,e,s){var r,h,o,n,l,a,d,c=this;if(null==s&&(s=!0),this.index=i,l=this.scrolled,this.clearScroll(),r=this.children[i],n=t.inArray(r,this.rotation),e&&"best"!==e||(e=this.bestDirection(r,n)),this.children.removeClass("active"),t(r).addClass("active").trigger(t.Event("film_roll:activate")),this.pager_links.removeClass("active"),t(this.pager_links[i]).addClass("active"),d=this.wrapper.width(),d<this.real_width&&this.children.length>1){if(a=(d-this.child_widths[i])/2,"right"===e)for(;0===n||this.marginLeft(n)<a;)this.rotateRight(),n=t.inArray(r,this.rotation);else for(;n===this.children.length-1||this.marginRight(n)<a;)this.rotateLeft(),n=t.inArray(r,this.rotation);o=-1*(this.marginLeft(n)-a),s?(h="moving_"+e,this.shuttle.addClass(h),this.div.trigger(t.Event("film_roll:moving")),this.shuttle.stop().transition({left:o},this.animation,this.easing,function(){return c.shuttle.removeClass(h),c.div.trigger(t.Event("film_roll:moved"))})):(this.shuttle.css("left",o),this.div.trigger(t.Event("film_roll:moved")))}else this.shuttle.css("left",(d-this.width)/2);return l&&this.configureScroll(),this},i.prototype.resize=function(){var i=this;return clearTimeout(this.resize_timer),this.resize_timer=setTimeout(function(){var e;return e=i.scrolled,i.clearScroll(),e&&i.configureScroll(),i.configureWidths(),i.moveToIndex(i.index,"best"),i.div.trigger(t.Event("film_roll:resized"))},200),this},i.prototype.rotateLeft=function(){var t,i,e;return t=this.shuttle.css("left"),e=t?parseInt(t,10):0,i=this.rotation.shift(),this.rotation.push(i),this.shuttle.css("left",e+this.childWidth(i)),this.shuttle.append(this.shuttle.children().first().detach())},i.prototype.rotateRight=function(){var t,i,e;return t=this.shuttle.css("left"),e=t?parseInt(t,10):0,i=this.rotation.pop(),this.rotation.unshift(i),this.shuttle.css("left",e-this.childWidth(i)),this.shuttle.prepend(this.shuttle.children().last().detach())},i}(),t.support.transition?FilmRoll.default_easing="cubic-bezier(.02,.01,.47,1)":(FilmRoll.default_easing="swing",t.fn.transition=t.fn.animate)}(jQuery);